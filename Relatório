	SELECT 
		SABOR,
		VENDA_SABOR.ANO,
		VOLUME_L,
		CONCAT(ROUND(((VOLUME_L / TOTAL_l) * 100), 1),
				'%') AS PORCENTAGEM
	FROM
		(SELECT 
			ANO, SUM(TOTAl) AS TOTAL_l
		FROM
			(SELECT 
			YEAR(DATA_VENDA) AS ANO,
				(SUM(QUANTIDADE) * B.TAMANHO) AS TOTAL,
				TAMANHO
		FROM
			itens_notas_fiscais A
		INNER JOIN notas_fiscais C ON A.NUMERO = C.NUMERO
		INNER JOIN vw_tamanho B ON B.CODIGO_DO_PRODUTO = A.CODIGO_DO_PRODUTO
			GROUP BY YEAR(DATA_VENDA) , B.TAMANHO) AS tb
		GROUP BY ANO) AS VENDA_TOTAL
			INNER JOIN
		(SELECT 
			SABOR, SUM(UNIDADE) AS VOLUME_L, ANO
		FROM
			(SELECT 
			SABOR,
				(SUM(QUANTIDADE) * D.TAMANHO) AS UNIDADE,
				YEAR(DATA_VENDA) AS ANO,
				D.TAMANHO
		FROM
			itens_notas_fiscais A
		INNER JOIN tabela_de_produtos b ON A.CODIGO_DO_PRODUTO = B.CODIGO_DO_PRODUTO
		INNER JOIN notas_fiscais C ON A.NUMERO = C.NUMERO
		INNER JOIN VW_TAMANHO D ON A.CODIGO_DO_PRODUTO = D.CODIGO_DO_PRODUTO
				GROUP BY SABOR , D.TAMANHO , YEAR(DATA_VENDA) ) AS TB_2
		GROUP BY SABOR , ANO) AS VENDA_SABOR ON VENDA_SABOR.ANO = VENDA_TOTAL.ANO
		GROUP BY SABOR , ANO
	ORDER BY ANO,VOLUME_L DESC;
